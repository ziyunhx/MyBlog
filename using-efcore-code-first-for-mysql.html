<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="Cache-Control" content="no-transform">
  
  <title>使用 EF Core CodeFirst 操作 Mysql 数据库 | 地平线</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="EntityFramework(以下简称EF) 作为 .NET 广受欢迎的数据库操作中间件，支持了几乎所有你用过的关系型数据库，本文将非常基础的介绍其在 Mysql 中的使用。EF 常见的使用模式有三种：CodeFirst, ModelFirst, DBFirst；三种方式各有所特点，一般要根据实际的业务情况做选择。">
<meta property="og:type" content="article">
<meta property="og:title" content="使用 EF Core CodeFirst 操作 Mysql 数据库">
<meta property="og:url" content="https://www.tnidea.com/using-efcore-code-first-for-mysql.html">
<meta property="og:site_name" content="地平线">
<meta property="og:description" content="EntityFramework(以下简称EF) 作为 .NET 广受欢迎的数据库操作中间件，支持了几乎所有你用过的关系型数据库，本文将非常基础的介绍其在 Mysql 中的使用。EF 常见的使用模式有三种：CodeFirst, ModelFirst, DBFirst；三种方式各有所特点，一般要根据实际的业务情况做选择。">
<meta property="og:updated_time" content="2016-12-22T16:37:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用 EF Core CodeFirst 操作 Mysql 数据库">
<meta name="twitter:description" content="EntityFramework(以下简称EF) 作为 .NET 广受欢迎的数据库操作中间件，支持了几乎所有你用过的关系型数据库，本文将非常基础的介绍其在 Mysql 中的使用。EF 常见的使用模式有三种：CodeFirst, ModelFirst, DBFirst；三种方式各有所特点，一般要根据实际的业务情况做选择。">
  
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  

  

  
  <script src="/js/classie.js" type="text/javascript"></script>
  <script src="/js/modernizr.custom.js" type="text/javascript"></script>
</head>
<body>
  <div id="container" class="cbp-spmenu-push">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <span id="mobile-logo" class="navigation-menu-button" id="js-mobile-menu"><i class="fa fa-bars mobile-menu-img">&nbsp;</i><span class="site-title">地平线</span></span>
      <a href="/" id="logo"><i class="logo" style="background-image: url(/css/images/logo.png)"></i></a>
      <!-- Nav -->
      <nav id="main-nav">
        <ul>
          
            
          
            
                <li class="main-nav-link">
                <a href="/archives">时间线
                    
                </a>
                
                </li>
            
          
            
                <li class="main-nav-link">
                <a href="javascript:void(0)">技术
                    
                        <i class="fa fa-angle-down" style="font-weight:600;color:#b6c1c9;"></i>
                    
                </a>
                
                    <ul class="menu-category-list"><li class="menu-category-list-item"><a class="menu-category-list-link" href="/categories/Storm/">Storm</a></li><li class="menu-category-list-item"><a class="menu-category-list-link" href="/categories/Thrinax/">Thrinax</a></li><li class="menu-category-list-item"><a class="menu-category-list-link" href="/categories/技术/">技术</a></li><li class="menu-category-list-item"><a class="menu-category-list-link" href="/categories/爬虫/">爬虫</a></li><li class="menu-category-list-item"><a class="menu-category-list-link" href="/categories/运维/">运维</a></li><li class="menu-category-list-item"><a class="menu-category-list-link" href="/categories/项目管理/">项目管理</a></li></ul>
                
                </li>
            
          
            
                <li class="main-nav-link">
                <a href="https://github.com/ziyunhx/">GitHub
                    
                </a>
                
                </li>
            
          
            
                <li class="main-nav-link">
                <a href="/about.html">关于我
                    
                </a>
                
                </li>
            
          
        </ul>
      </nav>
      
    </div>
  </div>
</header>

    <div class="outer">
      
      <section id="main"><article id="post-using-efcore-code-first-for-mysql" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      使用 EF Core CodeFirst 操作 Mysql 数据库
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
<br>
    <p style="border-top:1px solid #eceff2;margin:0 20px;"></p>
    <br>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- 博客正文广告 -->
    <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-6541442242935379"
        data-ad-slot="9453052931"
        data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

    <p> EntityFramework(以下简称EF) 作为 .NET 广受欢迎的数据库操作中间件，支持了几乎所有你用过的关系型数据库，本文将非常基础的介绍其在 Mysql 中的使用。EF 常见的使用模式有三种：CodeFirst, ModelFirst, DBFirst；三种方式各有所特点，一般要根据实际的业务情况做选择。</p>
<a id="more"></a>
<p> 在完全没有历史负担的情况下，选择 CodeFirst 更为普遍，在最新的 EntityFramework Core 中 CodeFirst 几乎是唯一的选择。本文将介绍如何使用 CodeFirst 创建和操作 Mysql 数据库，文中将以微信企业号的用户同步作为案例。IDE 使用 Visual Studio for Mac。</p>
<p> 首先，使用 Mac 版 Visual Studio 创建一个 Console Application(.NET Core) 项目：EFCoreSample。使用 Nuget 增加 EFCore 以及 Mysql 所需要的包：</p>
<ul>
<li>Microsoft.EntityFrameworkCore</li>
<li>MySql.Data.EntityFrameworkCore</li>
</ul>
<p> 然后，由于本次例子中会使用到微信企业号的 API，我们直接引用第三方包来实现：</p>
<ul>
<li>Senparc.Weixin</li>
<li>Senparc.Weixin.QY</li>
</ul>
<p> 第三步，在解决方案中新建一个 Models 文件夹，增加部门（Party），用户（User），标签（Tag）类，以及它们之间的相互关系部门标签（PartyTag），用户部门（UserParty），用户标签（UserTag）类，均为多对多关系。类的详细定义代码如下：</p>
<p> <strong> 部门（Party） </strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class Party&#10;&#123;&#10;    public Party()&#10;    &#123;&#10;        UserPartys = new List&#60;UserParty&#62;();&#10;        PartyTags = new List&#60;PartyTag&#62;();&#10;    &#125;&#10;&#10;    /// &#60;summary&#62;&#10;    /// &#37096;&#38376;Id&#10;    /// &#60;/summary&#62;&#10;    [Key]&#10;    public int PartyId &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#37096;&#38376;&#21517;&#31216;&#10;    /// &#60;/summary&#62;&#10;    [Required]&#10;    [StringLength(32)]&#10;    public string Name &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#22312;&#29238;&#37096;&#38376;&#20013;&#30340;&#27425;&#24207;&#20540;&#12290;order&#20540;&#23567;&#30340;&#25490;&#24207;&#38752;&#21069;&#12290;&#10;    /// &#60;/summary&#62;&#10;    public int Order &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#19978;&#32423;&#37096;&#38376;Id&#10;    /// &#60;/summary&#62;&#10;    public int ParentPartyId &#123; get; set; &#125;&#10;    public List&#60;UserParty&#62; UserPartys &#123; set; get; &#125;&#10;    public List&#60;PartyTag&#62; PartyTags &#123; set; get; &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p> <strong> 用户（User） </strong> </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class User&#10;&#123;&#10;    public User()&#10;    &#123;&#10;        UserPartys = new List&#60;UserParty&#62;();&#10;        UserTags = new List&#60;UserTag&#62;();&#10;    &#125;&#10;&#10;    /// &#60;summary&#62;&#10;    /// &#21592;&#24037;UserID&#10;    /// &#60;/summary&#62;&#10;    [Key]&#10;    [StringLength(32)]&#10;    public string UserId &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#22836;&#20687;url&#12290;&#27880;&#65306;&#23567;&#22270;&#23558;url&#26368;&#21518;&#30340;&#34;/0&#34;&#25913;&#25104;&#34;/64&#34;&#10;    /// &#60;/summary&#62;&#10;    [StringLength(256)]&#10;    public string Avatar &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#37038;&#31665;&#10;    /// &#60;/summary&#62;&#10;    [StringLength(256)]&#10;    public string Email &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#24615;&#21035;&#12290;gender=0&#34920;&#31034;&#30007;&#65292;=1&#34920;&#31034;&#22899;&#10;    /// &#60;/summary&#62;&#10;    public int Gender &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#25163;&#26426;&#21495;&#30721;&#10;    /// &#60;/summary&#62;&#10;    [StringLength(32)]&#10;    public string Mobile &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#25104;&#21592;&#21517;&#31216;&#10;    /// &#60;/summary&#62;&#10;    [StringLength(128)]&#10;    public string Name &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#32844;&#20301;&#20449;&#24687;&#10;    /// &#60;/summary&#62;&#10;    [StringLength(64)]&#10;    public string Position &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#20851;&#27880;&#29366;&#24577;: 1=&#24050;&#20851;&#27880;&#65292;2=&#24050;&#20923;&#32467;&#65292;4=&#26410;&#20851;&#27880;&#10;    /// &#60;/summary&#62;&#10;    public int Status &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#24494;&#20449;&#21495;&#10;    /// &#60;/summary&#62;&#10;    [StringLength(64)]&#10;    public string Weixinid &#123; get; set; &#125;&#10;    /// &#60;summary&#62;&#10;    /// &#25104;&#21592;&#25152;&#23646;&#37096;&#38376;&#21015;&#34920;&#10;    /// &#60;/summary&#62;&#10;    public List&#60;UserParty&#62; UserPartys &#123; get; set; &#125;&#10;    public List&#60;UserTag&#62; UserTags &#123; set; get; &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p> <strong> 标签（Tag） </strong> </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class Tag&#10;&#123;&#10;    public Tag()&#10;    &#123;&#10;        PartyTags = new List&#60;PartyTag&#62;();&#10;        UserTags = new List&#60;UserTag&#62;();&#10;    &#125;&#10;&#10;    [Key]&#10;    public int TagId &#123; set; get; &#125;&#10;    [Required]&#10;    [StringLength(64)]&#10;    public string TagName &#123; set; get; &#125;&#10;    public List&#60;PartyTag&#62; PartyTags &#123; get; set; &#125;&#10;    public List&#60;UserTag&#62; UserTags &#123; get; set; &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p> <strong> 部门标签（PartyTag） </strong> </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class PartyTag&#10;&#123;&#10;    public int PartyId &#123; set; get; &#125;&#10;    public Party Party &#123; set; get; &#125;&#10;&#10;    public int TagId &#123; set; get; &#125;&#10;    public Tag Tag &#123; set; get; &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p> <strong> 用户部门（UserParty） </strong> </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class UserParty&#10;&#123;&#10;    [StringLength(32)]&#10;    public string UserId &#123; set; get; &#125;&#10;    public User User &#123; set; get; &#125;&#10;&#10;    public int PartyId &#123; set; get; &#125;&#10;    public Party Party &#123; set; get; &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p> <strong> 用户标签（UserTag） </strong> </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class UserTag&#10;&#123;&#10;    [StringLength(32)]&#10;    public string UserId &#123; set; get; &#125;&#10;    public User User &#123; set; get; &#125;&#10;&#10;    public int TagId &#123; set; get; &#125;&#10;    public Tag Tag &#123; set; get; &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p> 第四步，增加 WechatContext 类来操作数据库：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public class WechatContext : DbContext&#10;&#123;&#10;    public DbSet&#60;User&#62; Users &#123; set; get; &#125;&#10;    public DbSet&#60;Party&#62; Partys &#123; set; get; &#125;&#10;    public DbSet&#60;Tag&#62; Tags &#123; set; get; &#125;&#10;    public DbSet&#60;PartyTag&#62; PartyTags &#123; set; get; &#125;&#10;    public DbSet&#60;UserParty&#62; UserPartys &#123; set; get; &#125;&#10;    public DbSet&#60;UserTag&#62; UserTags &#123; set; get; &#125;&#10;&#10;    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)&#10;        =&#62; optionsBuilder.UseMySQL(@&#34;server=127.0.0.1;user id=root;password=root;persistsecurityinfo=True;database=wechatdb;Character Set=utf8&#34;);&#10;&#10;    protected override void OnModelCreating(ModelBuilder modelBuilder)&#10;    &#123;&#10;        modelBuilder.Entity&#60;PartyTag&#62;()&#10;                    .HasKey(c =&#62; new &#123; c.PartyId, c.TagId &#125;);&#10;        modelBuilder.Entity&#60;UserParty&#62;()&#10;                    .HasKey(c =&#62; new &#123; c.PartyId, c.UserId &#125;);&#10;        modelBuilder.Entity&#60;UserTag&#62;()&#10;                    .HasKey(c =&#62; new &#123; c.UserId, c.TagId &#125;);&#10;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p> 需要注意以下几点：1，修改服务器的IP与用户名和密码；2，不要忘记连接字符串中的“Character Set=utf8”，否则会出现中文乱码；3，OnModelCreating 中定义了几个关系表的联合主键，不可缺少。</p>
<p> 第五步，创建 UserHelper 类，放置到 Core 文件夹中，代码如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/// &#60;summary&#62;&#10;/// &#29992;&#25143;&#24110;&#21161;&#31867;&#65292;&#29992;&#20110;&#23558;&#29992;&#25143;&#32452;&#65292;Tag&#31561;&#20449;&#24687;&#36716;&#25442;&#21040;&#20855;&#20307;&#30340;&#29992;&#25143;&#10;/// &#35813;&#31867;&#21487;&#33021;&#22312;&#36890;&#30693;&#20013;&#29992;&#21040;&#10;/// &#60;/summary&#62;&#10;public class UserHelper&#10;&#123;&#10;    private static string corpID = &#34;&#34;;&#10;    private static string corpSecret = &#34;&#34;;&#10;&#10;    /// &#60;summary&#62;&#10;    /// Get the wechat users and save to database.&#10;    /// &#60;/summary&#62;&#10;    /// &#60;returns&#62;&#60;/returns&#62;&#10;    public static bool GetWechatUserToDB()&#10;    &#123;&#10;        string token = AccessTokenContainer.TryGetToken(corpID, corpSecret);&#10;        WechatContext context = new WechatContext();&#10;&#10;        //todo: &#28165;&#31354;&#29616;&#26377;&#29992;&#25143;&#25968;&#25454;&#10;&#10;        //&#33719;&#21462;&#24494;&#20449;&#20225;&#19994;&#21495;&#20869;&#30340;&#29992;&#25143;&#26550;&#26500;&#20449;&#24687;&#10;        Dictionary&#60;string, List&#60;Tag&#62;&#62; _userTags = new Dictionary&#60;string, List&#60;Tag&#62;&#62;();&#10;        Dictionary&#60;int, List&#60;Tag&#62;&#62; _partyTags = new Dictionary&#60;int, List&#60;Tag&#62;&#62;();&#10;&#10;        Dictionary&#60;string, User&#62; Users = new Dictionary&#60;string, User&#62;();&#10;&#10;        //&#26597;&#25214;&#25152;&#26377;Tag&#24182;&#25554;&#20837;&#25968;&#25454;&#24211;&#10;        GetTagListResult tagList = MailListApi.GetTagList(token);&#10;&#10;        if (tagList != null &#38;&#38; tagList.taglist != null &#38;&#38; tagList.taglist.Count &#62; 0)&#10;        &#123;&#10;            foreach (var tag in tagList.taglist)&#10;            &#123;&#10;                int tagId = -1;&#10;                if (Int32.TryParse(tag.tagid, out tagId))&#10;                &#123;&#10;                    Tag tempTag = new Tag() &#123; TagId = tagId, TagName = tag.tagname &#125;;&#10;&#10;                    GetTagMemberResult tagMemberResult = MailListApi.GetTagMember(token, tagId);&#10;                    if (tagMemberResult != null &#38;&#38; tagMemberResult.partylist != null &#38;&#38; tagMemberResult.partylist.Length &#62; 0)&#10;                    &#123;&#10;                        foreach (int party in tagMemberResult.partylist)&#10;                        &#123;&#10;                            if (!_partyTags.ContainsKey(party))&#10;                                _partyTags[party] = new List&#60;Tag&#62;();&#10;&#10;                            _partyTags[party].Add(tempTag);&#10;                        &#125;&#10;                    &#125;&#10;&#10;                    if (tagMemberResult != null &#38;&#38; tagMemberResult.userlist != null &#38;&#38; tagMemberResult.userlist.Count &#62; 0)&#10;                    &#123;&#10;                        foreach (var tagUser in tagMemberResult.userlist)&#10;                        &#123;&#10;                            if (!_userTags.ContainsKey(tagUser.userid))&#10;                                _userTags[tagUser.userid] = new List&#60;Tag&#62;();&#10;&#10;                            _userTags[tagUser.userid].Add(tempTag);&#10;                        &#125;&#10;                    &#125;&#10;&#10;                    context.Tags.Add(tempTag);&#10;                &#125;&#10;            &#125;&#10;            context.SaveChanges();&#10;        &#125;&#10;&#10;        //&#26597;&#25214;&#25152;&#26377;&#37096;&#38376;&#24182;&#25554;&#20837;&#25968;&#25454;&#24211;&#10;        GetDepartmentListResult departmentList = MailListApi.GetDepartmentList(token);&#10;&#10;        if (departmentList != null &#38;&#38; departmentList.department != null)&#10;        &#123;&#10;            foreach (var party in departmentList.department)&#10;            &#123;&#10;                var tempParty = new Party() &#123; PartyId = party.id, Name = party.name, Order = party.order, ParentPartyId = party.parentid &#125;;&#10;&#10;                //&#27492;&#22788;&#38656;&#35201;&#26597;&#35810;&#25152;&#26377;&#30340;Tag&#20445;&#23384;&#21040;&#24211;&#20013;&#10;                if (_partyTags.ContainsKey(party.id))&#10;                &#123;&#10;                    tempParty.PartyTags = _partyTags[party.id].Select(f =&#62; new PartyTag() &#123; PartyId = tempParty.PartyId, TagId = f.TagId &#125;).ToList();&#10;                &#125;&#10;&#10;                //&#26681;&#25454;&#37096;&#38376;&#26597;&#25214;&#25152;&#26377;&#29992;&#25143;&#24182;&#23384;&#20837;&#32531;&#23384;&#10;                GetDepartmentMemberInfoResult memberInfos = MailListApi.GetDepartmentMemberInfo(token, party.id, 1, 0);&#10;                if (memberInfos != null &#38;&#38; memberInfos.userlist != null &#38;&#38; memberInfos.userlist.Count &#62; 0)&#10;                &#123;&#10;                    foreach (var member in memberInfos.userlist)&#10;                    &#123;&#10;                        if (!Users.ContainsKey(member.userid))&#10;                        &#123;&#10;                            Users[member.userid] = new User()&#10;                            &#123;&#10;                                Avatar = member.avatar,&#10;                                Email = member.email,&#10;                                Gender = member.gender,&#10;                                Mobile = member.mobile,&#10;                                Name = member.name,&#10;                                Position = member.position,&#10;                                Status = member.status,&#10;                                UserId = member.userid,&#10;                                Weixinid = member.weixinid,&#10;                                UserTags = (_userTags.ContainsKey(member.userid)&#38;&#38; _userTags[member.userid].Count &#62; 0) ? _userTags[member.userid].Select(f =&#62; new UserTag() &#123; UserId = member.userid, TagId = f.TagId &#125;).ToList() : null                                   &#10;                            &#125;;&#10;                        &#125;&#10;                        Users[member.userid].UserPartys.Add(new UserParty() &#123; PartyId = tempParty.PartyId, UserId = member.userid &#125;);&#10;                    &#125;&#10;                &#125;&#10;&#10;                context.Partys.Add(tempParty);&#10;            &#125;&#10;            context.SaveChanges();&#10;        &#125;&#10;&#10;        if (Users != null &#38;&#38; Users.Count &#62; 0)&#10;        &#123;&#10;            foreach(var user in  Users.Values)&#10;                context.Users.Add(user);&#10;&#10;            context.SaveChanges();&#10;        &#125;&#10;&#10;        return true;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p> 代码中的 corpID 和 corpSecret 需要在微信企业号中获得，如果你没有企业号，那么将仅能创建一个空的数据库，而无法同步到任何数据。</p>
<p> 最后，在 Program 中调用数据库创建以及用户同步方法：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">class Program&#10;&#123;&#10;    static void Main(string[] args)&#10;    &#123;&#10;        //&#21028;&#26029;&#25968;&#25454;&#24211;&#26159;&#21542;&#23384;&#22312;,&#22914;&#26524;&#19981;&#23384;&#22312;&#21017;&#21019;&#24314;&#34920;&#10;        WechatContext context = new WechatContext();&#10;&#10;        if (!context.Database.EnsureCreated())&#10;        &#123;&#10;            Console.WriteLine(&#34;Error: Unable to create the mysql database&#65281;&#34;);&#10;        &#125;&#10;        else&#10;        &#123;&#10;            Console.WriteLine(&#34;Create and Connect to MySQL success&#65281;&#34;);&#10;&#10;            //&#21021;&#22987;&#21270;&#24494;&#20449;&#29992;&#25143;&#20851;&#31995;&#25968;&#25454;&#10;            if (UserHelper.GetWechatUserToDB())&#10;            &#123;&#10;                Console.WriteLine(&#34;Init wechat users to MySQL db success&#65281;&#34;);&#10;            &#125;&#10;            else&#10;            &#123;&#10;                Console.WriteLine(&#34;Error: Unable to Init wechat users to MySQL db&#65281;&#34;);&#10;            &#125;&#10;        &#125;&#10;    &#125;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>至此，一个简单的 Demo 就完成了，由于篇幅有限，许多地方都还有需要优化的地方，此处就不一一介绍了，完整代码可以在 <a href="https://github.com/ziyunhx/Samples/tree/master/EFCoreSample" target="_blank" rel="external">EFCoreSample</a> 查看。执行后你就可以在数据库看到结果了！</p>

    <p>本文来自 <a href="https://www.tnidea.com/" title="The NewIdea" target="_blank" rel="external">The NewIdea</a>，作者 Carey Tzou 。<br>永久地址：<a href="https://www.tnidea.com/using-efcore-code-first-for-mysql.html" title="使用 EF Core CodeFirst 操作 Mysql 数据库" target="_blank" rel="external">https://www.tnidea.com/using-efcore-code-first-for-mysql.html</a><br>未经授权，拒绝任何全文及摘要转载！<br>
    <br>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- 博客正文广告 -->
    <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-6541442242935379"
        data-ad-slot="9453052931"
        data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    <br/>
    <p>欢迎关注微信公众号：CareyTzou（dotNet大数据）</p>
    <a href="https://www.tnidea.com/media/image/wechat.jpg" title="Wechat:CareyTzou" class="fancybox" rel="article0"><img style="width:160px;display:inline;" src="https://www.tnidea.com/media/image/wechat.jpg" alt="Wechat:CareyTzou"></a>
    
    </div>
    
    <footer class="article-footer">
    
  <div class="article-date">
    <a href="/using-efcore-code-first-for-mysql.html">
      <time datetime="2016-12-22T16:00:00.000Z" itemprop="datePublished">2016-12-23</time>
    </a>
  </div>


      <a data-url="https://www.tnidea.com/using-efcore-code-first-for-mysql.html" data-id="cix0l5qjf0000d7s36ufzqg9o" class="article-share-link">分享到</a>
    
  <div class="article-tag">
    <i class="fa fa-tags"></i>&nbsp;&nbsp;
  </div>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NET/">.NET</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/EFCore/">EFCore</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/new-netcore-unstructured-text-capture-lib-thrinax.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          .Net文本抽取类库 Thrinax（一）基于网页区块的正文抽取
        
      </div>
    </a>
  
  
    <a href="/protect-your-elasticsearch.html" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">保护好你的Elasticsearch全文检索库</div>
    </a>
  
</nav>


  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/NET/" style="font-size: 20px;">.NET</a> <a href="/tags/NET-Core/" style="font-size: 11.43px;">.NET Core</a> <a href="/tags/Baidu/" style="font-size: 10px;">Baidu</a> <a href="/tags/C/" style="font-size: 18.57px;">C#</a> <a href="/tags/CentOS/" style="font-size: 15.71px;">CentOS</a> <a href="/tags/DRPC/" style="font-size: 14.29px;">DRPC</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/EFCore/" style="font-size: 10px;">EFCore</a> <a href="/tags/Elasticsearch/" style="font-size: 10px;">Elasticsearch</a> <a href="/tags/Hadoop-MapReduce/" style="font-size: 10px;">Hadoop MapReduce</a> <a href="/tags/Html2Article/" style="font-size: 10px;">Html2Article</a> <a href="/tags/HttpHelper/" style="font-size: 10px;">HttpHelper</a> <a href="/tags/HttpWebRequest/" style="font-size: 10px;">HttpWebRequest</a> <a href="/tags/Icinga-Web2/" style="font-size: 15.71px;">Icinga Web2</a> <a href="/tags/Icinga2/" style="font-size: 15.71px;">Icinga2</a> <a href="/tags/ImitateLogin/" style="font-size: 10px;">ImitateLogin</a> <a href="/tags/Memory/" style="font-size: 10px;">Memory</a> <a href="/tags/Network/" style="font-size: 10px;">Network</a> <a href="/tags/OpenAuth/" style="font-size: 10px;">OpenAuth</a> <a href="/tags/SVN/" style="font-size: 10px;">SVN</a> <a href="/tags/SearchGuard/" style="font-size: 10px;">SearchGuard</a> <a href="/tags/Snapshot/" style="font-size: 10px;">Snapshot</a> <a href="/tags/Spark-Streaming/" style="font-size: 10px;">Spark Streaming</a> <a href="/tags/Storm/" style="font-size: 14.29px;">Storm</a> <a href="/tags/Topology/" style="font-size: 15.71px;">Topology</a> <a href="/tags/VS/" style="font-size: 11.43px;">VS</a> <a href="/tags/charset/" style="font-size: 11.43px;">charset</a> <a href="/tags/csharp/" style="font-size: 18.57px;">csharp</a> <a href="/tags/dotnet/" style="font-size: 11.43px;">dotnet</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/mono/" style="font-size: 10px;">mono</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/open-auth-assist/" style="font-size: 10px;">open-auth-assist</a> <a href="/tags/social-network/" style="font-size: 12.86px;">social network</a> <a href="/tags/storm/" style="font-size: 17.14px;">storm</a> <a href="/tags/thrift/" style="font-size: 12.86px;">thrift</a> <a href="/tags/wechat/" style="font-size: 10px;">wechat</a> <a href="/tags/wordcount/" style="font-size: 11.43px;">wordcount</a> <a href="/tags/zookeeper/" style="font-size: 10px;">zookeeper</a> <a href="/tags/分布式/" style="font-size: 11.43px;">分布式</a> <a href="/tags/多语言/" style="font-size: 10px;">多语言</a> <a href="/tags/微信/" style="font-size: 10px;">微信</a> <a href="/tags/批处理/" style="font-size: 11.43px;">批处理</a> <a href="/tags/插件机制/" style="font-size: 10px;">插件机制</a> <a href="/tags/文件版本号/" style="font-size: 11.43px;">文件版本号</a> <a href="/tags/服务器监控/" style="font-size: 15.71px;">服务器监控</a> <a href="/tags/正文识别/" style="font-size: 10px;">正文识别</a> <a href="/tags/流式框架/" style="font-size: 11.43px;">流式框架</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a> <a href="/tags/部署/" style="font-size: 10px;">部署</a> <a href="/tags/项目管理/" style="font-size: 10px;">项目管理</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Storm/">Storm</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Thrinax/">Thrinax</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/爬虫/">爬虫</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维/">运维</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/项目管理/">项目管理</a><span class="category-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">时间线</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">十一月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">十月 2013</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2013-2018 The NewIdea Inc.  <span id="footer-info-extend">鄂ICP备15011767号-1</span>
    </div>
  </div>
</footer>
    

<script>
  var disqus_shortname = 'tnidea';
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



 <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>




  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?855c1789992bb648e4734a1e1045c672";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
  </div>
    <div id="mobile-nav">
    <nav class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1">
      
        <a href="/.">首页</a>
        
      
        <a href="/archives">时间线</a>
        
      
        <a href="javascript:void(0)">技术</a>
        
          <ul class="main-nav-category-list"><li class="main-nav-category-list-item"><a class="main-nav-category-list-link" href="/categories/Storm/">Storm</a></li><li class="main-nav-category-list-item"><a class="main-nav-category-list-link" href="/categories/Thrinax/">Thrinax</a></li><li class="main-nav-category-list-item"><a class="main-nav-category-list-link" href="/categories/技术/">技术</a></li><li class="main-nav-category-list-item"><a class="main-nav-category-list-link" href="/categories/爬虫/">爬虫</a></li><li class="main-nav-category-list-item"><a class="main-nav-category-list-link" href="/categories/运维/">运维</a></li><li class="main-nav-category-list-item"><a class="main-nav-category-list-link" href="/categories/项目管理/">项目管理</a></li></ul>
        
      
        <a href="https://github.com/ziyunhx/">GitHub</a>
        
      
        <a href="/about.html">关于我</a>
        
      
      <div id="nav-search-form">
        <form class="search-form"><input id="bdcsMain" type="search" name="q" results="0" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit"> </button></form>
      </div>
    </nav>
  </div>
  <script>
    var menuLeft = document.getElementById( 'cbp-spmenu-s1' ),
        showMobileNav = document.getElementById( 'mobile-logo' ),
        container = document.getElementById( 'container' );
  
    showMobileNav.onclick = function() {
      classie.toggle( this, 'active' );
      classie.toggle( container, 'cbp-spmenu-push-toright' );
      classie.toggle( menuLeft, 'cbp-spmenu-open' );
    };
  </script>
</body>
</html>