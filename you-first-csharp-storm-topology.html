<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>使用Csharp创建你的第一个Storm拓扑（wordcount） | 地平线</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="WordCount在大数据领域就像学习一门语言时的hello world，得益于Storm的开源以及Storm.Net.Adapter，现在我们也可以像Java或Python一样，使用Csharp创建原生支持的Storm Topologies。下面我将通过介绍wordcount来展示如何使用Csharp开发Storm拓扑。">
<meta property="og:type" content="article">
<meta property="og:title" content="使用Csharp创建你的第一个Storm拓扑（wordcount）">
<meta property="og:url" content="http://www.tnidea.com/you-first-csharp-storm-topology.html">
<meta property="og:site_name" content="地平线">
<meta property="og:description" content="WordCount在大数据领域就像学习一门语言时的hello world，得益于Storm的开源以及Storm.Net.Adapter，现在我们也可以像Java或Python一样，使用Csharp创建原生支持的Storm Topologies。下面我将通过介绍wordcount来展示如何使用Csharp开发Storm拓扑。">
<meta property="og:image" content="http://www.tnidea.com/media/image/wordcount-project.png">
<meta property="og:image" content="http://www.tnidea.com/media/image/wordcount-topology.png">
<meta property="og:updated_time" content="2015-10-07T08:18:04.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用Csharp创建你的第一个Storm拓扑（wordcount）">
<meta name="twitter:description" content="WordCount在大数据领域就像学习一门语言时的hello world，得益于Storm的开源以及Storm.Net.Adapter，现在我们也可以像Java或Python一样，使用Csharp创建原生支持的Storm Topologies。下面我将通过介绍wordcount来展示如何使用Csharp开发Storm拓扑。">
  
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
  

  

  
  <script src="/js/classie.js" type="text/javascript"></script>
  <script src="/js/modernizr.custom.js" type="text/javascript"></script>
</head>
<body>
  <div id="container" class="cbp-spmenu-push">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <span id="mobile-logo" class="navigation-menu-button" id="js-mobile-menu"><i class="fa fa-bars mobile-menu-img">&nbsp;</i><span class="site-title">地平线</span></span>
      <a href="/" id="logo"><i class="logo" style="background-image: url(/css/images/logo.png)"></i></a>
      <!-- Nav -->
      <nav id="main-nav">
        <ul>
          
            
          
            
                <li class="main-nav-link">
                <a href="/archives">时间线
                    
                </a>
                
                </li>
            
          
            
                <li class="main-nav-link">
                <a href="javascript:void(0)">技术
                    
                        <i class="fa fa-angle-down" style="font-weight:600;color:#b6c1c9;"></i>
                    
                </a>
                
                    <ul class="menu-category-list"><li class="menu-category-list-item"><a class="menu-category-list-link" href="/categories/Storm/">Storm</a></li><li class="menu-category-list-item"><a class="menu-category-list-link" href="/categories/爬虫/">爬虫</a></li><li class="menu-category-list-item"><a class="menu-category-list-link" href="/categories/运维/">运维</a></li><li class="menu-category-list-item"><a class="menu-category-list-link" href="/categories/项目管理/">项目管理</a></li></ul>
                
                </li>
            
          
            
                <li class="main-nav-link">
                <a href="https://github.com/ziyunhx/">GitHub
                    
                </a>
                
                </li>
            
          
            
                <li class="main-nav-link">
                <a href="/about.html">关于我
                    
                </a>
                
                </li>
            
          
        </ul>
      </nav>
      
      <div id="search-form-wrap">
        <form class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit"> </button></form>
      </div>
    </div>
  </div>
</header>

    <div class="outer">
      
      <section id="main"><article id="post-you-first-csharp-storm-topology" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      使用Csharp创建你的第一个Storm拓扑（wordcount）
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
<br>
    <p style="border-top:1px solid #eceff2;margin:0 20px;"></p>
    <br>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- 博客正文广告 -->
    <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-6541442242935379"
        data-ad-slot="9453052931"
        data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

    <p> WordCount在大数据领域就像学习一门语言时的hello world，得益于Storm的开源以及<a href="https://github.com/ziyunhx/storm-net-adapter" title="Storm.Net.Adapter" target="_blank" rel="external">Storm.Net.Adapter</a>，现在我们也可以像Java或Python一样，使用Csharp创建原生支持的Storm Topologies。下面我将通过介绍wordcount来展示如何使用Csharp开发Storm拓扑。</p>
<a id="more"></a>
<p> 上篇博客已经介绍了如何部署Storm开发环境，本文所讲述demo已包含在<a href="https://github.com/ziyunhx/storm-net-adapter" title="Storm.Net.Adapter" target="_blank" rel="external">Storm.Net.Adapter</a>中，如果你觉得对你有帮助，欢迎Star和Fork，让更多人看到来帮助完善这个项目。</p>
<p> 首先，我们创建一个控制台应用程序（使用控制台是方便调用） StormSimple；使用Nuget添加添加Storm.Net.Adapter（该类库的namespace为Storm）。</p>
<p><img src="http://www.tnidea.com/media/image/wordcount-project.png" alt="wordcount project"></p>
<p> <strong>STEP1</strong>：通过继承ISpout创建一个Spout：Generator，实现ISpout的四个方法：</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Open</span>(<span class="params">Config stormConf, TopologyContext context</span>)</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NextTuple</span>(<span class="params"></span>)</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Ack</span>(<span class="params"><span class="keyword">long</span> seqId</span>)</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Fail</span>(<span class="params"><span class="keyword">long</span> seqId</span>)</span>;</span><br></pre></td></tr></table></figure>
<p> 在实现这4个方法之前，我们还需要创建一些变量和方法来初始化这个类：</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> Context ctx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Generator</span>(<span class="params">Context ctx</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">	Context.Logger.Info(<span class="string">"Generator constructor called"</span>);</span><br><span class="line">	<span class="keyword">this</span>.ctx = ctx;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Declare Output schema</span></span><br><span class="line">	Dictionary&lt;<span class="keyword">string</span>, List&lt;Type&gt;&gt; outputSchema = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, List&lt;Type&gt;&gt;();</span><br><span class="line">	outputSchema.Add(<span class="string">"default"</span>, <span class="keyword">new</span> List&lt;Type&gt;() &#123; <span class="keyword">typeof</span>(<span class="keyword">string</span>) &#125;);</span><br><span class="line">	<span class="keyword">this</span>.ctx.DeclareComponentSchema(<span class="keyword">new</span> ComponentStreamSchema(<span class="keyword">null</span>, outputSchema));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 我使用了一个私有变量<code>ctx</code>来保存实例化时传入的Context对象，Context有一个静态的Logger，用于日志的发送，我们无需实例化即可使用它。根据日志级别不同，包含 Trace Debug Info Warn Error 五个级别，另外我们在实例化方法里还需要定义输入和输出的参数的数量和类型，本例子中输入为<code>null</code>，输出为一个字符串。另外我们还创建一个方法来直接返回实例化后的类：</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span>  Implements of delegate "newPlugin", which is used to create a instance of this spout/bolt</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="ctx"&gt;</span>Context instance<span class="xmlDocTag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;returns&gt;</span><span class="xmlDocTag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Generator <span class="title">Get</span>(<span class="params">Context ctx</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Generator(ctx);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 其中Open在该类第一次任务调用前执行，主要用于预处理和一些配置信息的传入，大多数情况下，我们并不需要做什么；NextTuple方法用于生成Tuple，会不断被调用，因此如果没什么任务要向下发送，可以使用<code>Thread.Sleep(50);</code>来减少CPU的消耗（具体休息时间与Topology设置有关，只要不超过超时时间就没有问题）。</p>
<p> 本例子中NextTuple主要用于从一个包含英语句子的数组中随机取出一条句子，并把它发送到下一个环节，为了能够保证所有的任务都被成功执行一遍，我们将发送的消息缓存起来，并且限制正在执行中的任务数量为20。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">const</span> <span class="keyword">int</span> MAX_PENDING_TUPLE_NUM = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">long</span> lastSeqId = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">private</span> Dictionary&lt;<span class="keyword">long</span>, <span class="keyword">string</span>&gt; cachedTuples = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">long</span>, <span class="keyword">string</span>&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Random rand = <span class="keyword">new</span> Random();</span><br><span class="line"><span class="keyword">string</span>[] sentences = <span class="keyword">new</span> <span class="keyword">string</span>[] &#123;</span><br><span class="line">                                  <span class="string">"the cow jumped over the moon"</span>,</span><br><span class="line">                                  <span class="string">"an apple a day keeps the doctor away"</span>,</span><br><span class="line">                                  <span class="string">"four score and seven years ago"</span>,</span><br><span class="line">                                  <span class="string">"snow white and the seven dwarfs"</span>,</span><br><span class="line">                                  <span class="string">"i am at two with nature"</span>&#125;;</span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> This method is used to emit one or more tuples. If there is nothing to emit, this method should return without emitting anything. </span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> It should be noted that NextTuple(), Ack(), and Fail() are all called in a tight loop in a single thread in C# process. </span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> When there are no tuples to emit, it is courteous to have NextTuple sleep for a short amount of time (such as 10 milliseconds), so as not to waste too much CPU.</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">NextTuple</span>(<span class="params"></span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">    Context.Logger.Info(<span class="string">"NextTuple enter"</span>);</span><br><span class="line">    <span class="keyword">string</span> sentence;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (cachedTuples.Count &lt;= MAX_PENDING_TUPLE_NUM)</span><br><span class="line">    &#123;</span><br><span class="line">        lastSeqId++;</span><br><span class="line">        sentence = sentences[rand.Next(<span class="number">0</span>, sentences.Length - <span class="number">1</span>)];</span><br><span class="line">        Context.Logger.Info(<span class="string">"Generator Emit: &#123;0&#125;, seqId: &#123;1&#125;"</span>, sentence, lastSeqId);</span><br><span class="line">        <span class="keyword">this</span>.ctx.Emit(<span class="string">"default"</span>, <span class="keyword">new</span> List&lt;<span class="keyword">object</span>&gt;() &#123; sentence &#125;, lastSeqId);</span><br><span class="line">        cachedTuples[lastSeqId] = sentence;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// if have nothing to emit, then sleep for a little while to release CPU</span></span><br><span class="line">        Thread.Sleep(<span class="number">50</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Context.Logger.Info(<span class="string">"cached tuple num: &#123;0&#125;"</span>, cachedTuples.Count);</span><br><span class="line"></span><br><span class="line">    Context.Logger.Info(<span class="string">"Generator NextTx exit"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> <code>this.ctx.Emit</code> 即用来把Topology发送给下一个Bolt。</p>
<p> Ack()和Fail()方法分别在整个Topology执行成功和Topology失败时被调用。本例中Ack主要是移除缓存，Fail主要是用于取出缓存数据并重新发送Tuple。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> Ack() will be called only when ack mechanism is enabled in spec file.</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> If ack is not supported in non-transactional topology, the Ack() can be left as empty function. </span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="seqId"&gt;</span>Sequence Id of the tuple which is acked.<span class="xmlDocTag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Ack</span>(<span class="params"><span class="keyword">long</span> seqId</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">    Context.Logger.Info(<span class="string">"Ack, seqId: &#123;0&#125;"</span>, seqId);</span><br><span class="line">    <span class="keyword">bool</span> result = cachedTuples.Remove(seqId);</span><br><span class="line">    <span class="keyword">if</span> (!result)</span><br><span class="line">    &#123;</span><br><span class="line">        Context.Logger.Warn(<span class="string">"Ack(), remove cached tuple for seqId &#123;0&#125; fail!"</span>, seqId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> Fail() will be called only when ack mechanism is enabled in spec file. </span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> If ack is not supported in non-transactional topology, the Fail() can be left as empty function.</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="seqId"&gt;</span>Sequence Id of the tuple which is failed.<span class="xmlDocTag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fail</span>(<span class="params"><span class="keyword">long</span> seqId</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">    Context.Logger.Info(<span class="string">"Fail, seqId: &#123;0&#125;"</span>, seqId);</span><br><span class="line">    <span class="keyword">if</span> (cachedTuples.ContainsKey(seqId))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">string</span> sentence = cachedTuples[seqId];</span><br><span class="line">        Context.Logger.Info(<span class="string">"Re-Emit: &#123;0&#125;, seqId: &#123;1&#125;"</span>, sentence, seqId);</span><br><span class="line">        <span class="keyword">this</span>.ctx.Emit(<span class="string">"default"</span>, <span class="keyword">new</span> List&lt;<span class="keyword">object</span>&gt;() &#123; sentence &#125;, seqId);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Context.Logger.Warn(<span class="string">"Fail(), can't find cached tuple for seqId &#123;0&#125;!"</span>, seqId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 至此，一个Spout就算完成了，下面我们继续分析Bolt。</p>
<p> <strong>STEP2</strong>：通过继承IBasicBolt创建Bolt：Splitter、Counter。</p>
<p> Splitter是一个通过空格来拆分英语句子为一个个独立的单词，Counter则用来统计各个单词出现的次数。我们只详细分析Splitter，Counter类仅贴出全部源码。</p>
<p> 和Generator相同，我们首先也要构造一个实例化方法方便使用者传参和调用：</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> Context ctx;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> msgTimeoutSecs;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Splitter</span>(<span class="params">Context ctx</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">    Context.Logger.Info(<span class="string">"Splitter constructor called"</span>);</span><br><span class="line">    <span class="keyword">this</span>.ctx = ctx;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Declare Input and Output schemas</span></span><br><span class="line">    Dictionary&lt;<span class="keyword">string</span>, List&lt;Type&gt;&gt; inputSchema = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, List&lt;Type&gt;&gt;();</span><br><span class="line">    inputSchema.Add(<span class="string">"default"</span>, <span class="keyword">new</span> List&lt;Type&gt;() &#123; <span class="keyword">typeof</span>(<span class="keyword">string</span>) &#125;);</span><br><span class="line">    Dictionary&lt;<span class="keyword">string</span>, List&lt;Type&gt;&gt; outputSchema = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, List&lt;Type&gt;&gt;();</span><br><span class="line">    outputSchema.Add(<span class="string">"default"</span>, <span class="keyword">new</span> List&lt;Type&gt;() &#123; <span class="keyword">typeof</span>(<span class="keyword">string</span>), <span class="keyword">typeof</span>(<span class="keyword">char</span>) &#125;);</span><br><span class="line">    <span class="keyword">this</span>.ctx.DeclareComponentSchema(<span class="keyword">new</span> ComponentStreamSchema(inputSchema, outputSchema));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Demo how to get stormConf info</span></span><br><span class="line">    <span class="keyword">if</span> (Context.Config.StormConf.ContainsKey(<span class="string">"topology.message.timeout.secs"</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        msgTimeoutSecs = Convert.ToInt32(Context.Config.StormConf[<span class="string">"topology.message.timeout.secs"</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    Context.Logger.Info(<span class="string">"msgTimeoutSecs: &#123;0&#125;"</span>, msgTimeoutSecs);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span>  Implements of delegate "newPlugin", which is used to create a instance of this spout/bolt</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="ctx"&gt;</span>Context instance<span class="xmlDocTag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;returns&gt;</span><span class="xmlDocTag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Splitter <span class="title">Get</span>(<span class="params">Context ctx</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Splitter(ctx);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 在这个实例化方法中，我们增加了一个没有使用的变量<code>msgTimeoutSecs</code>用来展示如何获取Topology的配置。</p>
<p> 由于继承了IBasicBolt，我们需要实现以下两个方法：</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Prepare</span>(<span class="params">Config stormConf, TopologyContext context</span>)</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Execute</span>(<span class="params">StormTuple tuple</span>)</span>;</span><br></pre></td></tr></table></figure>
<p> 这和IBolt是一致的，IBasicBolt和IBolt的区别仅仅在于后者需要自己处理何时向Storm发送Ack或Fail，IBasicBolt则不需要关心这些，如果你的Execute没有抛出异常的话，总会在最后向Storm发送Ack，否则则发送Fail。Prepare则是用于执行前的预处理，此例子里同样什么都不需要做。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> The Execute() function will be called, when a new tuple is available.</span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="tuple"&gt;</span><span class="xmlDocTag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Execute</span>(<span class="params">StormTuple tuple</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">    Context.Logger.Info(<span class="string">"Execute enter"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">string</span> sentence = tuple.GetString(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">string</span> word <span class="keyword">in</span> sentence.Split(<span class="string">' '</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        Context.Logger.Info(<span class="string">"Splitter Emit: &#123;0&#125;"</span>, word);</span><br><span class="line">        <span class="keyword">this</span>.ctx.Emit(<span class="string">"default"</span>, <span class="keyword">new</span> List&lt;StormTuple&gt; &#123; tuple &#125;, <span class="keyword">new</span> List&lt;<span class="keyword">object</span>&gt; &#123; word, word[<span class="number">0</span>] &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Context.Logger.Info(<span class="string">"Splitter Execute exit"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Prepare</span>(<span class="params">Config stormConf, TopologyContext context</span>)</span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> Counter和上述的代码类似：</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> Storm;</span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">StormSample</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> The bolt "counter" uses a dictionary to record the occurrence number of each word.</span></span><br><span class="line">    <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Counter</span> : <span class="title">IBasicBolt</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> Context ctx;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">int</span>&gt; counts = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">int</span>&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Counter</span>(<span class="params">Context ctx</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            Context.Logger.Info(<span class="string">"Counter constructor called"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">this</span>.ctx = ctx;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Declare Input and Output schemas</span></span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, List&lt;Type&gt;&gt; inputSchema = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, List&lt;Type&gt;&gt;();</span><br><span class="line">            inputSchema.Add(<span class="string">"default"</span>, <span class="keyword">new</span> List&lt;Type&gt;() &#123; <span class="keyword">typeof</span>(<span class="keyword">string</span>), <span class="keyword">typeof</span>(<span class="keyword">char</span>) &#125;);</span><br><span class="line"></span><br><span class="line">            Dictionary&lt;<span class="keyword">string</span>, List&lt;Type&gt;&gt; outputSchema = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">string</span>, List&lt;Type&gt;&gt;();</span><br><span class="line">            outputSchema.Add(<span class="string">"default"</span>, <span class="keyword">new</span> List&lt;Type&gt;() &#123; <span class="keyword">typeof</span>(<span class="keyword">string</span>), <span class="keyword">typeof</span>(<span class="keyword">int</span>) &#125;);</span><br><span class="line">            <span class="keyword">this</span>.ctx.DeclareComponentSchema(<span class="keyword">new</span> ComponentStreamSchema(inputSchema, outputSchema));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="xmlDocTag">///</span> The Execute() function will be called, when a new tuple is available.</span></span><br><span class="line">        <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="tuple"&gt;</span><span class="xmlDocTag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Execute</span>(<span class="params">StormTuple tuple</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            Context.Logger.Info(<span class="string">"Execute enter"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> word = tuple.GetString(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">int</span> count = counts.ContainsKey(word) ? counts[word] : <span class="number">0</span>;</span><br><span class="line">            count++;</span><br><span class="line">            counts[word] = count;</span><br><span class="line"></span><br><span class="line">            Context.Logger.Info(<span class="string">"Counter Emit: &#123;0&#125;, count: &#123;1&#125;"</span>, word, count);</span><br><span class="line">            <span class="keyword">this</span>.ctx.Emit(<span class="string">"default"</span>, <span class="keyword">new</span> List&lt;StormTuple&gt; &#123; tuple &#125;, <span class="keyword">new</span> List&lt;<span class="keyword">object</span>&gt; &#123; word, count &#125;);</span><br><span class="line"></span><br><span class="line">            Context.Logger.Info(<span class="string">"Counter Execute exit"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="xmlDocTag">///</span>  Implements of delegate "newPlugin", which is used to create a instance of this spout/bolt</span></span><br><span class="line">        <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;param name="ctx"&gt;</span>Context instance<span class="xmlDocTag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="xmlDocTag">///</span> <span class="xmlDocTag">&lt;returns&gt;</span><span class="xmlDocTag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Counter <span class="title">Get</span>(<span class="params">Context ctx</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Counter(ctx);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Prepare</span>(<span class="params">Config stormConf, TopologyContext context</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> <strong>STEP3</strong>：修改Program.cs来方便使用Java调用。</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> Storm;</span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">StormSample</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (args.Count() &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">string</span> compName = args[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="string">"generator"</span>.Equals(compName))</span><br><span class="line">                    &#123;</span><br><span class="line">                        ApacheStorm.LaunchPlugin(<span class="keyword">new</span> newPlugin(Generator.Get));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params"><span class="string">"splitter"</span>.Equals(compName</span>))</span><br><span class="line">                    </span>&#123;</span><br><span class="line">                        ApacheStorm.LaunchPlugin(<span class="keyword">new</span> newPlugin(Splitter.Get));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="function"><span class="keyword">else</span> <span class="title">if</span> (<span class="params"><span class="string">"counter"</span>.Equals(compName</span>))</span><br><span class="line">                    </span>&#123;</span><br><span class="line">                        ApacheStorm.LaunchPlugin(<span class="keyword">new</span> newPlugin(Counter.Get));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="keyword">string</span>.Format(<span class="string">"unexpected compName: &#123;0&#125;"</span>, compName));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">                &#123;</span><br><span class="line">                    Context.Logger.Error(ex.ToString());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Context.Logger.Error(<span class="string">"Not support local model."</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 我们在Main方法里使用参数来确定具体调用的是哪个Spout/Bolt，ApacheStorm是一个包含主要方法的类，之所以不使用Storm只是因为命名空间占用了它。Csharp端的代码到此就全部结束了，Java端的代码与部署发布将在下一篇详细介绍，敬请期待！下面让我们来看一看整个Topology的流程吧！</p>
<p> <img src="http://www.tnidea.com/media/image/wordcount-topology.png" alt="WordCount Topology"></p>

    <p>本文来自 <a href="http://www.tnidea.com/" title="The NewIdea" target="_blank" rel="external">The NewIdea</a>，作者 Carey Tzou 。<br>永久地址：<a href="http://www.tnidea.com/you-first-csharp-storm-topology.html" title="使用Csharp创建你的第一个Storm拓扑（wordcount）" target="_blank" rel="external">http://www.tnidea.com/you-first-csharp-storm-topology.html</a><br>未经授权，拒绝任何全文及摘要转载！<br>
    <br>
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- 博客正文广告 -->
    <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-6541442242935379"
        data-ad-slot="9453052931"
        data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

    <p>欢迎关注微信公众号：CareyTzou（dotNet大数据）</p>
    <a href="http://www.tnidea.com/media/image/wechat.jpg" title="Wechat:CareyTzou" class="fancybox" rel="article0"><img style="width:160px;display:inline;" src="http://www.tnidea.com/media/image/wechat.jpg" alt="Wechat:CareyTzou"></a>
    
    </div>
    
    <footer class="article-footer">
    
  <div class="article-date">
    <a href="/you-first-csharp-storm-topology.html">
      <time datetime="2015-06-03T16:00:00.000Z" itemprop="datePublished">2015-06-04</time>
    </a>
  </div>


      <a data-url="http://www.tnidea.com/you-first-csharp-storm-topology.html" data-id="cij8lxqyj000go8s3u56d47o0" class="article-share-link">分享到</a>
      
        <a href="http://www.tnidea.com/you-first-csharp-storm-topology.html#disqus_thread" class="article-comment-link">评论</a>
      
      
  <div class="article-tag">
    <i class="fa fa-tags"></i>&nbsp;&nbsp;
  </div>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NET/">.NET</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/">C#</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Storm/">Storm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/csharp/">csharp</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/deploy-wordcount-topology.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          创建Maven项目打包提交wordcount到Storm集群
        
      </div>
    </a>
  
  
    <a href="/deploy-storm-environment.html" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">搭建.Net开发Storm拓扑的环境</div>
    </a>
  
</nav>


  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/NET/" style="font-size: 20px;">.NET</a> <a href="/tags/Baidu/" style="font-size: 10px;">Baidu</a> <a href="/tags/C/" style="font-size: 20px;">C#</a> <a href="/tags/CentOS/" style="font-size: 16.67px;">CentOS</a> <a href="/tags/DRPC/" style="font-size: 15px;">DRPC</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Hadoop-MapReduce/" style="font-size: 10px;">Hadoop MapReduce</a> <a href="/tags/HttpHelper/" style="font-size: 10px;">HttpHelper</a> <a href="/tags/HttpWebRequest/" style="font-size: 10px;">HttpWebRequest</a> <a href="/tags/Icinga-Web2/" style="font-size: 16.67px;">Icinga Web2</a> <a href="/tags/Icinga2/" style="font-size: 16.67px;">Icinga2</a> <a href="/tags/ImitateLogin/" style="font-size: 10px;">ImitateLogin</a> <a href="/tags/Memory/" style="font-size: 10px;">Memory</a> <a href="/tags/Network/" style="font-size: 10px;">Network</a> <a href="/tags/OpenAuth/" style="font-size: 10px;">OpenAuth</a> <a href="/tags/SVN/" style="font-size: 10px;">SVN</a> <a href="/tags/Spark-Streaming/" style="font-size: 10px;">Spark Streaming</a> <a href="/tags/Storm/" style="font-size: 15px;">Storm</a> <a href="/tags/Topology/" style="font-size: 15px;">Topology</a> <a href="/tags/VS/" style="font-size: 11.67px;">VS</a> <a href="/tags/charset/" style="font-size: 10px;">charset</a> <a href="/tags/csharp/" style="font-size: 18.33px;">csharp</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/mono/" style="font-size: 10px;">mono</a> <a href="/tags/open-auth-assist/" style="font-size: 10px;">open-auth-assist</a> <a href="/tags/social-network/" style="font-size: 13.33px;">social network</a> <a href="/tags/storm/" style="font-size: 16.67px;">storm</a> <a href="/tags/thrift/" style="font-size: 13.33px;">thrift</a> <a href="/tags/wechat/" style="font-size: 10px;">wechat</a> <a href="/tags/wordcount/" style="font-size: 11.67px;">wordcount</a> <a href="/tags/zookeeper/" style="font-size: 10px;">zookeeper</a> <a href="/tags/分布式/" style="font-size: 11.67px;">分布式</a> <a href="/tags/多语言/" style="font-size: 10px;">多语言</a> <a href="/tags/微信/" style="font-size: 10px;">微信</a> <a href="/tags/批处理/" style="font-size: 11.67px;">批处理</a> <a href="/tags/插件机制/" style="font-size: 10px;">插件机制</a> <a href="/tags/文件版本号/" style="font-size: 11.67px;">文件版本号</a> <a href="/tags/服务器监控/" style="font-size: 16.67px;">服务器监控</a> <a href="/tags/流式框架/" style="font-size: 11.67px;">流式框架</a> <a href="/tags/部署/" style="font-size: 10px;">部署</a> <a href="/tags/项目管理/" style="font-size: 10px;">项目管理</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Storm/">Storm</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/爬虫/">爬虫</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/运维/">运维</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/项目管理/">项目管理</a><span class="category-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">时间线</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">十一月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">十月 2013</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2013-2016 The NewIdea Inc.  <span id="footer-info-extend">鄂ICP备15011767号-1</span>
    </div>
  </div>
</footer>
    

<script>
  var disqus_shortname = 'tnidea';
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



 <script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>




  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','e2e3X_cz-QvzonvQg7eP','2.0.0');
</script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?855c1789992bb648e4734a1e1045c672";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

  </div>
    <div id="mobile-nav">
    <nav class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1">
      
        <a href="/.">首页</a>
        
      
        <a href="/archives">时间线</a>
        
      
        <a href="javascript:void(0)">技术</a>
        
          <ul class="main-nav-category-list"><li class="main-nav-category-list-item"><a class="main-nav-category-list-link" href="/categories/Storm/">Storm</a></li><li class="main-nav-category-list-item"><a class="main-nav-category-list-link" href="/categories/爬虫/">爬虫</a></li><li class="main-nav-category-list-item"><a class="main-nav-category-list-link" href="/categories/运维/">运维</a></li><li class="main-nav-category-list-item"><a class="main-nav-category-list-link" href="/categories/项目管理/">项目管理</a></li></ul>
        
      
        <a href="https://github.com/ziyunhx/">GitHub</a>
        
      
        <a href="/about.html">关于我</a>
        
      
      <div id="nav-search-form">
        <form class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit"> </button></form>
      </div>
    </nav>
  </div>
  <script>
    var menuLeft = document.getElementById( 'cbp-spmenu-s1' ),
        showMobileNav = document.getElementById( 'mobile-logo' ),
        container = document.getElementById( 'container' );
  
    showMobileNav.onclick = function() {
      classie.toggle( this, 'active' );
      classie.toggle( container, 'cbp-spmenu-push-toright' );
      classie.toggle( menuLeft, 'cbp-spmenu-open' );
    };
  </script>
</body>
</html>